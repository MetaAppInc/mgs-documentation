
# MGS接入指南

## 1. 开发者平台

如果已经完成过注册, 可以跳过此步骤.

- 首先进行[注册认证](https://dev.233leyuan.com/#/doc/9)
- 将`MGS安卓SDK`部分对接全部完成后, 进行[游戏上传](https://dev.233leyuan.com/#/doc/6)
- 请注意[合作须知](https://dev.233leyuan.com/#/doc/5)
- **TODO 20210224** MGS特有的开发者平台操作步骤, 设置字段, 设置语音频道和文字聊天维度. 这部分功能目前会由`MGS集成工程师操作`, 后续会开放UI页面

## 2. 对接成功自测, 样例游戏代码参考

接入完成后, 请参考[接入流程](https://dev.233leyuan.com/#/doc/1)按以下步骤自测.

- **TODO 20210224** 联运自测步骤, 这部分测试目前会由`MGS集成小队`配合进行
- **TODO 20210224** MGS自测步骤, 这部分测试目前会由`MGS集成小队`配合进行

## 3. MGS SDK简要流程

MGS提供轻量+可拓展的安卓SDK供游戏客户端使用,还提供服务端API, 对于一些特定接口, 由游戏服务端发起调用.

- **TODO 20210224** SDK会由`MGS集成工程师`提供, 形式是标准安卓aar文件

- MGS登录流程

![](https://cdn.233xyx.com/1614085716890_248.jpg)

- MGS房间操作流程

![](https://cdn.233xyx.com/1614085717113_485.jpg)


## 4. 分功能接入介绍

### 1. 账号登录

在233乐园环境中, 游戏客户端获取233乐园玩家的信息, 包括openId, 昵称, 游戏时长等. 游戏会绑定玩家的openId.

### 2. 好友邀请

游戏调用MGS安卓SDK接口, 来向其他玩家发送好友请求. 同时玩家可以邀请他们在233乐园中的好友, 来到您的游戏中一起游玩.

### 3. 房间匹配

房间部分是233乐园提供给游戏的重要流量入口和曝光位置. 对于游戏的房间模式, 有2大类: 普通房间模式和队伍房间模式. 另一个维度上, 对于游戏与MGS的接入方式上, 有同步房间和托管房间两种方式

#### 房间模式: 普通房间模式 Room

典型例子为斗地主, 象棋, 乱斗等. 核心特点是, 游戏建立的一个房间里面包含所有本局游戏的玩家, 开始后即玩.

此时, Room = 游戏建立的房间 = 233乐园联机大厅展示的房间.

#### 房间模式: 队伍房间模式 Party - Team - Room

**TODO 20210224** 本功能为二期功能, 目前尚未开放

典型例子为MOBA的组排 / 五黑, 核心特点是, 游戏建立的一个房间里面包含的是一个队伍的玩家. 准备开始后, 需要匹配另外一个 (或多个) 队伍. 匹配成功后所有队伍的人进入一个大房间, 开始游戏.

根据配置, 队伍或者是必须满员才能开始匹配, 或者是两人 / 三人后就可以开始匹配 (双排 / 三排场景).

此时, Group = 游戏建立的房间 = 233乐园联机大厅展示的房间.

匹配时, 一个或多个Group组成一个Team, 两个或多个Team构成一个Room, Room中的所有玩家参与一局游戏.

#### 接入方式: 同步房间

![](https://cdn.233xyx.com/1616562567493_081.png)

在这种方式下, 玩家在233乐园中点选 相应游戏 / 加入房间 (如上图), 会直接拉起游戏客户端. 游戏客户端会调用MGS安卓SDK获知用户的动作 (如：拉起游戏, 加入101848房间, 创建房间, 快速匹配等), 然后做相应操作. 游戏现有的匹配逻辑可以全部保留, 不受影响. 当加入房间 / 创建房间等动作成功后 (游戏服务端会检查房间是否已满, 玩家等级是否可以加入该房间, 匹配玩家等级段位地区符合规则等等), 向MGS同步. MGS会更新233乐园联机大厅中的房间列表.

#### 接入方式: 托管房间

**TODO 20210224** 本功能尚未开放

### 4. 语音频道和文字聊天

![](https://cdn.233xyx.com/1612448289651_035.png)

语音频道和文字聊天呈现在233乐园悬浮层上. 游戏只需要配置是否需要语音频道和文字聊天, 语音频道和文字聊天放在哪个层级.

以MOBA 5v5举例, 语音频道和文字聊天可以存在于group层级 (也就是双排的两个人), 也可以存在于team层级 (也就是我方五人), 也可以存在于room层级 (全场10个人). 语音频道和文字聊天还可以关掉, 如果游戏特性决定不可以允许用户随时自由交流. 常见的, 会把语音频道和文字聊天都各只选一个层级配置. 如果比如文字聊天配置了多个层级, 玩家会需要在不同文字聊天室间来回切换发言.

### 5. 样例游戏服务端和样例游戏客户端

我们提供了已经完成集成的样例游戏服务端和样例游戏客户端, 勇闯233, 供参考
